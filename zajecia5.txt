 -- 1
SELECT produkty.id_produktu , produkty.nazwa , produkty.cena
FROM produkty
ORDER BY produkty.cena DESC;
-- 2
SELECT kategorie.nazwa , produkty.nazwa , produkty.cena
FROM kategorie
JOIN produkty ON produkty.id_kategorii = kategorie.id_kategorii  
ORDER BY kategorie.nazwa ASC, produkty.cena DESC, produkty.nazwa ASC;
-- 3
SELECT klienci.miasto, klienci.nazwisko, klienci.imie
FROM klienci
ORDER BY klienci.miasto COLLATE utf8mb4_polish_ci, klienci.nazwisko, klienci.imie;
-- 4
SELECT zamowienia.id_zamowienia, zamowienia.status, zamowienia.data_zamowienia
FROM zamowienia
ORDER BY    
CASE zamowienia.status        
WHEN 'zrealizowane' THEN 1        
WHEN 'w realizacji' THEN 2        
WHEN 'anulowane' THEN 3  
END, zamowienia.data_zamowienia DESC;
-- 5
SELECT klienci.id_klienta, klienci.imie, klienci.nazwisko, 
       SUM(platnosci.kwota) AS laczna_kwota
FROM klienci
LEFT JOIN zamowienia ON klienci.id_klienta = zamowienia.id_klienta
LEFT JOIN platnosci ON zamowienia.id_zamowienia = platnosci.id_zamowienia
GROUP BY klienci.id_klienta, klienci.imie, klienci.nazwisko
ORDER BY laczna_kwota DESC;

-- 6
SELECT kategorie.id_kategorii, kategorie.nazwa, SUM(produkty.cena) AS suma_cen
FROM kategorie
JOIN produkty ON kategorie.id_kategorii = produkty.id_kategorii
GROUP BY kategorie.id_kategorii, kategorie.nazwa
ORDER BY suma_cen DESC, kategorie.nazwa ASC;
-- 7
SELECT zamowienia.id_zamowienia, zamowienia.id_klienta, zamowienia.data_zamowienia, zamowienia.status
FROM zamowienia
ORDER BY zamowienia.data_zamowienia DESC, zamowienia.id_zamowienia ASC
LIMIT 5;
-- 8
SELECT produkty.id_produktu, produkty.nazwa, produkty.cena
FROM produkty
WHERE nazwa LIKE '%Monitor%'
ORDER BY nazwa ASC, cena ASC;
