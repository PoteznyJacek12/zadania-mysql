
-- zadanie 1
SELECT lista_filmow.ocena, COUNT(*) AS liczba_filmów
FROM lista_filmow
GROUP BY ocena;


-- zadanie 2
SELECT lista_filmow.kategoria, COUNT(*) AS liczba_filmów
FROM lista_filmow
JOIN kategoria  ON kategoria.kategoria_id = lista_filmow.FID
GROUP BY lista_filmow.kategoria;

-- zadanie 3
SELECT film.tytul, COUNT(*) AS liczba_aktorów
FROM film
JOIN film_aktor  ON film.film_id = film_aktor.film_id
GROUP BY film.tytul;

-- zadanie 4
SELECT SUM(platnosc.kwota) AS Suma, klient.imie
FROM platnosc
JOIN klient  ON klient.klient_id = platnosc.klient_id
GROUP BY klient.imie;

-- zadanie 5
SELECT film.tytul, SUM(platnosc.kwota)
FROM film
JOIN spis  ON spis.film_id = film.film_id
JOIN wypozyczenie  ON wypozyczenie.spis_id = spis.spis_id
JOIN platnosc  ON platnosc.wypozyczenie_id =wypozyczenie.wypozyczenie_id
GROUP BY film.tytul

-- zadanie 6
SELECT kategoria.nazwa, AVG(film.stawka_wypozycz),  AVG(film.koszty_wymiany)
FROM film
JOIN film_kategoria  ON film_kategoria.film_id = film.film_id
JOIN kategoria  ON kategoria.kategoria_id = film_kategoria.kategoria_id

GROUP BY kategoria.nazwa;


-- zadanie 7
SELECT klient.imie, AVG(platnosc.kwota)
FROM klient
JOIN platnosc  ON platnosc.klient_id = klient.klient_id


GROUP BY klient.imie;